================================================================================
VOTING & POLLS SYSTEM - COMPLETE PAGE SPECIFICATIONS
RoomMate Manager - Democratic Decision Making Module
================================================================================

OVERVIEW
--------
The Voting & Polls system enables democratic decision-making within apartments.
Admins create polls, members vote, and results drive actions automatically.

KEY FEATURES
-----------
âœ“ Multiple poll types (Yes/No, Multiple Choice, Rating, Open-ended)
âœ“ Customizable quorum and majority requirements
âœ“ Anonymous voting option
âœ“ Live or hidden results during voting
âœ“ Automated dispute escalation to voting
âœ“ Real-time vote counting
âœ“ Automatic poll closure and result publishing
âœ“ Voter notifications and reminders
âœ“ Poll templates for common decisions
âœ“ Integration with loyalty points

================================================================================
1. POLLS DASHBOARD
================================================================================

Route: /polls
Component: PollsDashboardPage.tsx
Permission: All Apartment Members

LAYOUT STRUCTURE
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Polls & Voting ğŸ—³ï¸                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ â”‚Active    â”‚ â”‚Voted     â”‚ â”‚Points    â”‚    â”‚
â”‚ â”‚Polls     â”‚ â”‚This      â”‚ â”‚Earned    â”‚    â”‚
â”‚ â”‚3         â”‚ â”‚Month     â”‚ â”‚48 pts    â”‚    â”‚
â”‚ â”‚[Vote!]   â”‚ â”‚12 âœ“     â”‚ â”‚(24 votes)â”‚    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âš ï¸ URGENT: Dispute requires your vote!     â”‚
â”‚ Ends in 6 hours | [Vote Now â†’]             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Tabs: [Active] [Completed] [All]           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ACTIVE POLLS (3)                            â”‚
â”‚                                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ â”‚ ğŸ½ï¸ Add Biryani to Friday Menu?     â”‚    â”‚
â”‚ â”‚ Poll Type: Yes/No                    â”‚    â”‚
â”‚ â”‚ Created: Jan 2 by Admin              â”‚    â”‚
â”‚ â”‚ Ends: Jan 5, 6:00 PM (in 12 hours)  â”‚    â”‚
â”‚ â”‚ Voted: 12/17 (71%) âœ“ Quorum Met     â”‚    â”‚
â”‚ â”‚ Current Results: Hidden              â”‚    â”‚
â”‚ â”‚ [Cast Your Vote â†’]                   â”‚    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ â”‚ ğŸ  Approve New Roommate: Alex Kumar â”‚    â”‚
â”‚ â”‚ Poll Type: Yes/No                    â”‚    â”‚
â”‚ â”‚ Created: Jan 1 by Admin              â”‚    â”‚
â”‚ â”‚ Ends: Jan 7, 11:59 PM (5 days)      â”‚    â”‚
â”‚ â”‚ Voted: 8/17 (47%) âš ï¸ Needs Quorum    â”‚    â”‚
â”‚ â”‚ Your Vote: âœ“ Yes (voted Jan 2)      â”‚    â”‚
â”‚ â”‚ Current: Yes 75%, No 25% (visible)  â”‚    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ â”‚ âš–ï¸ DISPUTE: December Electricity    â”‚    â”‚
â”‚ â”‚ Poll Type: Decision                  â”‚    â”‚
â”‚ â”‚ Created: Jan 3 (Auto-escalated)     â”‚    â”‚
â”‚ â”‚ Ends: Jan 5, 3:00 PM (6 hours) ğŸ”¥   â”‚    â”‚
â”‚ â”‚ Voted: 14/17 (82%) âœ“ Quorum Met     â”‚    â”‚
â”‚ â”‚ [View Dispute] [Vote Now]           â”‚    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ RECENTLY COMPLETED                           â”‚
â”‚                                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ â”‚ âœ“ Best Weekend for Movie Night      â”‚    â”‚
â”‚ â”‚ Result: Saturday Won (65%)          â”‚    â”‚
â”‚ â”‚ Closed: Jan 1                       â”‚    â”‚
â”‚ â”‚ [View Results]                      â”‚    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

POLL CARD STATES
---------------
1. Not Voted Yet (Call-to-action)
   - Prominent "Cast Your Vote" button
   - Countdown timer
   - Quorum status indicator
   
2. Already Voted
   - Show what user voted
   - "Voted on [date]" badge
   - Live results (if enabled)
   
3. Ending Soon (<24 hours)
   - Orange/yellow indicator
   - Large countdown
   - Persistent notification
   
4. Completed
   - Final results
   - Winner/outcome
   - Implementation status

COMPONENTS
----------
1. SummaryCards
   - ActivePollsCard (count + action)
   - VotedThisMonthCard (participation %)
   - PointsEarnedCard (from voting)
   
2. UrgentPollBanner
   - Appears for ending soon + not voted
   - Dismissible
   - Links to poll
   
3. TabNavigation
   - Active (default, shows count)
   - Completed
   - All
   
4. PollCard
   - Conditional rendering based on state
   - Expandable details
   - Action buttons
   
5. QuorumIndicator
   - Progress bar (voted/total)
   - Color coded (green if met, red if not)

API CALLS
---------
```typescript
// Get user's apartment polls
GET /rest/v1/polls?apartment_id=eq.{apartmentId}&order=created_at.desc

// Get user's votes
GET /rest/v1/poll_votes?voter_member_id=eq.{memberId}

// Get voting summary
GET /functions/v1/voting-summary?user_id={userId}
```

REAL-TIME SUBSCRIPTION
--------------------
```typescript
supabase
  .channel('polls_updates')
  .on('postgres_changes', {
    event: 'INSERT',
    schema: 'public',
    table: 'polls',
    filter: `apartment_id=eq.${apartmentId}`
  }, handleNewPoll)
  .on('postgres_changes', {
    event: 'UPDATE',
    schema: 'public',
    table: 'poll_options'
  }, handleVoteCountUpdate)
  .subscribe()
```


================================================================================
2. VOTING PAGE
================================================================================

Route: /polls/:pollId/vote
Component: VotingPage.tsx
Permission: Eligible voter (apartment member)

YES/NO POLL LAYOUT
-----------------
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â† Back to Polls                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ½ï¸ Add Biryani to Friday Menu?             â”‚
â”‚ Created by Admin on Jan 2, 2025             â”‚
â”‚ Ends: Jan 5, 6:00 PM (11 hours remaining)   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ DESCRIPTION                                  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ Many members have requested Biryani    â”‚  â”‚
â”‚ â”‚ on the Friday menu. This will replace  â”‚  â”‚
â”‚ â”‚ the current Rice + Curry option.       â”‚  â”‚
â”‚ â”‚                                         â”‚  â”‚
â”‚ â”‚ Estimated cost: +â‚¹50 per person/week   â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ VOTING STATUS                                â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ Voted: 12/17 (71%)                     â”‚  â”‚
â”‚ â”‚ [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘] âœ“ Quorum Met   â”‚  â”‚
â”‚ â”‚                                         â”‚  â”‚
â”‚ â”‚ Quorum Required: 50% (9/17)            â”‚  â”‚
â”‚ â”‚ Majority Required: 50%                 â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ CAST YOUR VOTE                               â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚                                         â”‚  â”‚
â”‚ â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚  â”‚
â”‚ â”‚   â”‚         YES âœ“           â”‚         â”‚  â”‚
â”‚ â”‚   â”‚  Add Biryani to menu    â”‚         â”‚  â”‚
â”‚ â”‚   â”‚                          â”‚         â”‚  â”‚
â”‚ â”‚   â”‚    [Click to Vote]       â”‚         â”‚  â”‚
â”‚ â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚  â”‚
â”‚ â”‚                                         â”‚  â”‚
â”‚ â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚  â”‚
â”‚ â”‚   â”‚         NO âœ—            â”‚         â”‚  â”‚
â”‚ â”‚   â”‚  Keep current menu      â”‚         â”‚  â”‚
â”‚ â”‚   â”‚                          â”‚         â”‚  â”‚
â”‚ â”‚   â”‚    [Click to Vote]       â”‚         â”‚  â”‚
â”‚ â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚  â”‚
â”‚ â”‚                                         â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                              â”‚
â”‚ ğŸ”’ This is an anonymous poll.               â”‚
â”‚ Your vote will not be visible to others.    â”‚
â”‚                                              â”‚
â”‚ ğŸ’¡ Earn +2 loyalty points by voting!        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

MULTIPLE CHOICE POLL LAYOUT
--------------------------
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ¬ Best Day for Movie Night?                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ CAST YOUR VOTE (Select one)                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ âšª Friday Night                         â”‚  â”‚
â”‚ â”‚    7:00 PM - 10:00 PM                  â”‚  â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚ â”‚ âšª Saturday Afternoon                   â”‚  â”‚
â”‚ â”‚    3:00 PM - 6:00 PM                   â”‚  â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚ â”‚ âšª Saturday Night                       â”‚  â”‚
â”‚ â”‚    8:00 PM - 11:00 PM                  â”‚  â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚ â”‚ âšª Sunday Afternoon                     â”‚  â”‚
â”‚ â”‚    4:00 PM - 7:00 PM                   â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                              â”‚
â”‚ [Submit Vote]                                â”‚
â”‚                                              â”‚
â”‚ Live Results (12 votes):                    â”‚
â”‚ Friday Night:     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ 40% (5)        â”‚
â”‚ Saturday Afternoon: â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘ 20% (2)      â”‚
â”‚ Saturday Night:    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 60% (7) ğŸ‘‘   â”‚
â”‚ Sunday Afternoon:  â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 10% (1)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

RATING POLL LAYOUT
-----------------
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â­ Rate Chef Performance - December          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ CAST YOUR RATING                             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ Food Quality                            â”‚  â”‚
â”‚ â”‚ â­â­â­â­â­                                 â”‚  â”‚
â”‚ â”‚ (Click stars to rate 1-5)              â”‚  â”‚
â”‚ â”‚                                         â”‚  â”‚
â”‚ â”‚ Taste                                   â”‚  â”‚
â”‚ â”‚ â­â­â­â­â˜†                                 â”‚  â”‚
â”‚ â”‚                                         â”‚  â”‚
â”‚ â”‚ Presentation                            â”‚  â”‚
â”‚ â”‚ â­â­â­â­â­                                 â”‚  â”‚
â”‚ â”‚                                         â”‚  â”‚
â”‚ â”‚ Timeliness                              â”‚  â”‚
â”‚ â”‚ â­â­â­â­â­                                 â”‚  â”‚
â”‚ â”‚                                         â”‚  â”‚
â”‚ â”‚ Overall: 4.5/5 (auto-average)          â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                              â”‚
â”‚ Additional Feedback (optional):              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚Food has been great this month! Would   â”‚  â”‚
â”‚ â”‚love more variety in breakfast options. â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                              â”‚
â”‚ [Submit Rating]                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

VOTING FLOW
----------
1. User clicks vote option
2. Confirmation modal (optional, for important polls)
3. Submit vote:
```typescript
const vote = {
  poll_id: pollId,
  option_id: selectedOptionId,
  voter_member_id: userId,
  voted_at: new Date()
}

await supabase.from('poll_votes').insert(vote)

// Increment option vote count
await supabase.rpc('increment_vote_count', {
  option_id: selectedOptionId
})
```

4. Award loyalty points (+2)
5. Show success message
6. Display results (if allowed)
7. Real-time update dashboard

VOTE CONFIRMATION MODAL
-----------------------
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Confirm Your Vote                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ You are voting:                           â”‚
â”‚ YES - Add Biryani to Friday Menu          â”‚
â”‚                                            â”‚
â”‚ âš ï¸ You cannot change your vote after     â”‚
â”‚    submission.                            â”‚
â”‚                                            â”‚
â”‚ Are you sure?                             â”‚
â”‚                                            â”‚
â”‚ [Cancel] [Confirm Vote]                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```


================================================================================
3. POLL RESULTS PAGE
================================================================================

Route: /polls/:pollId/results
Component: PollResultsPage.tsx
Permission: All members after poll closes

LAYOUT STRUCTURE
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â† Back to Polls                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ½ï¸ Add Biryani to Friday Menu?             â”‚
â”‚ Status: âœ“ CLOSED | Winner: YES              â”‚
â”‚ Ended: Jan 5, 2025 6:00 PM                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ FINAL RESULTS                                â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ Total Votes: 15/17 (88%)               â”‚  â”‚
â”‚ â”‚ âœ“ Quorum Met (required: 50%)           â”‚  â”‚
â”‚ â”‚ âœ“ Majority Achieved (required: 50%)    â”‚  â”‚
â”‚ â”‚                                         â”‚  â”‚
â”‚ â”‚ Outcome: APPROVED âœ“                    â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ VOTE BREAKDOWN                               â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ âœ… YES - Add Biryani                   â”‚  â”‚
â”‚ â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 80% (12 votes) ğŸ‘‘ â”‚  â”‚
â”‚ â”‚                                         â”‚  â”‚
â”‚ â”‚ âŒ NO - Keep current menu              â”‚  â”‚
â”‚ â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 20% (3 votes)                    â”‚  â”‚
â”‚ â”‚                                         â”‚  â”‚
â”‚ â”‚ ğŸ”˜ Did Not Vote: 2 members             â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ IMPLEMENTATION                               â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ âœ“ Menu updated for next week            â”‚  â”‚
â”‚ â”‚ âœ“ Chef notified                         â”‚  â”‚
â”‚ â”‚ âœ“ Grocery teams adjusted                â”‚  â”‚
â”‚ â”‚ Status: Implemented on Jan 6            â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PARTICIPATION                                â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ Top Voters (This Month):                â”‚  â”‚
â”‚ â”‚ 1. Sarah - 15 votes                    â”‚  â”‚
â”‚ â”‚ 2. Mike - 14 votes                     â”‚  â”‚
â”‚ â”‚ 3. You - 12 votes                      â”‚  â”‚
â”‚ â”‚                                         â”‚  â”‚
â”‚ â”‚ Non-voters this poll:                  â”‚  â”‚
â”‚ â”‚ â€¢ John (notified, no response)         â”‚  â”‚
â”‚ â”‚ â€¢ Lisa (notified, no response)         â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [Download Report PDF]                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

RESULT CALCULATION
-----------------
```typescript
function calculatePollResults(poll: Poll, votes: Vote[]) {
  const totalEligible = poll.eligible_voters_count
  const totalVoted = votes.length
  const votingPercentage = (totalVoted / totalEligible) * 100
  
  // Check quorum
  const quorumMet = votingPercentage >= poll.quorum_percentage
  
  // Count votes per option
  const optionCounts = votes.reduce((acc, vote) => {
    acc[vote.option_id] = (acc[vote.option_id] || 0) + 1
    return acc
  }, {})
  
  // Find winner
  const winner = Object.entries(optionCounts)
    .sort(([,a], [,b]) => b - a)[0]
  
  const winnerPercentage = (winner[1] / totalVoted) * 100
  
  // Check majority
  const majorityAchieved = winnerPercentage >= poll.majority_percentage
  
  return {
    totalEligible,
    totalVoted,
    votingPercentage,
    quorumMet,
    winner: {
      optionId: winner[0],
      votes: winner[1],
      percentage: winnerPercentage
    },
    majorityAchieved,
    approved: quorumMet && majorityAchieved
  }
}
```


================================================================================
4. CREATE POLL (ADMIN)
================================================================================

Route: /admin/polls/create
Component: CreatePollPage.tsx
Permission: Admin

LAYOUT STRUCTURE
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Create New Poll                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Poll Type *                                  â”‚
â”‚ [Select Type â–¼]                             â”‚
â”‚ â€¢ Yes/No (binary decision)                  â”‚
â”‚ â€¢ Multiple Choice (single selection)        â”‚
â”‚ â€¢ Multiple Choice (multi-selection)         â”‚
â”‚ â€¢ Rating (1-5 stars)                        â”‚
â”‚ â€¢ Open-ended (text feedback)                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Poll Title *                                 â”‚
â”‚ [Enter clear, concise question_________]    â”‚
â”‚                                              â”‚
â”‚ Description                                  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚Provide context and details...          â”‚  â”‚
â”‚ â”‚                                         â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Options (for Multiple Choice)                â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ Option 1: [Friday Night________] [Ã—]   â”‚  â”‚
â”‚ â”‚ Option 2: [Saturday Afternoon__] [Ã—]   â”‚  â”‚
â”‚ â”‚ Option 3: [Saturday Night______] [Ã—]   â”‚  â”‚
â”‚ â”‚ Option 4: [Sunday Afternoon____] [Ã—]   â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚ [+ Add Option] (2-10 options allowed)       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Duration & Timing                            â”‚
â”‚ Start Date: [ğŸ“… Jan 5, 2025] [â° 9:00 AM]  â”‚
â”‚ End Date:   [ğŸ“… Jan 8, 2025] [â° 6:00 PM]  â”‚
â”‚ Duration: 3 days, 9 hours                   â”‚
â”‚                                              â”‚
â”‚ Quick Select:                                â”‚
â”‚ [24 Hours] [48 Hours] [3 Days] [1 Week]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Voting Settings                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ Quorum Requirement                      â”‚  â”‚
â”‚ â”‚ [50%] of eligible voters must vote     â”‚  â”‚
â”‚ â”‚ Minimum: 9 votes (based on 17 members) â”‚  â”‚
â”‚ â”‚                                         â”‚  â”‚
â”‚ â”‚ Majority Requirement                    â”‚  â”‚
â”‚ â”‚ [50%] of votes needed to pass          â”‚  â”‚
â”‚ â”‚                                         â”‚  â”‚
â”‚ â”‚ â˜ Anonymous Voting                     â”‚  â”‚
â”‚ â”‚   Hide who voted for what              â”‚  â”‚
â”‚ â”‚                                         â”‚  â”‚
â”‚ â”‚ â˜‘ Show Live Results                    â”‚  â”‚
â”‚ â”‚   Display results during voting        â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Eligible Voters                              â”‚
â”‚ âšª All Apartment Members (17)               â”‚
â”‚ âšª Only Roommates (exclude guests)          â”‚
â”‚ âšª Only Meal Participants (14)              â”‚
â”‚ âšª Custom Selection [Select Members...]     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Category *                                   â”‚
â”‚ [Select Category â–¼]                         â”‚
â”‚ â€¢ Menu Voting                               â”‚
â”‚ â€¢ General Decision                          â”‚
â”‚ â€¢ Team Formation                            â”‚
â”‚ â€¢ Rule Change                               â”‚
â”‚ â€¢ New Member Approval                       â”‚
â”‚ â€¢ Dispute Resolution                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [Save as Draft] [Create & Publish]          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

FORM VALIDATION
--------------
```typescript
const createPollSchema = yup.object({
  pollType: yup.string().required(),
  title: yup.string().required().min(10).max(255),
  description: yup.string().max(1000),
  options: yup.array()
    .of(yup.string().required())
    .min(2, 'At least 2 options required')
    .max(10, 'Maximum 10 options'),
  startDate: yup.date().required(),
  endDate: yup.date()
    .required()
    .min(yup.ref('startDate'), 'End date must be after start date'),
  quorumPercentage: yup.number().min(0).max(100).default(50),
  majorityPercentage: yup.number().min(0).max(100).default(50),
  anonymous: yup.boolean().default(false),
  showLiveResults: yup.boolean().default(true),
  eligibleVoters: yup.string().required(),
  category: yup.string().required()
})
```

POLL TEMPLATES
-------------
Quick-start templates:

1. Menu Addition Template
   - Type: Yes/No
   - Duration: 3 days
   - Eligible: Meal participants
   - Quorum: 50%, Majority: 50%

2. New Member Approval Template
   - Type: Yes/No
   - Duration: 7 days
   - Eligible: All roommates
   - Quorum: 75%, Majority: 66%

3. Rule Change Template
   - Type: Yes/No
   - Duration: 5 days
   - Eligible: All members
   - Quorum: 66%, Majority: 66%

4. Team Selection Template
   - Type: Multiple Choice
   - Duration: 2 days
   - Eligible: Relevant team members

5. Dispute Resolution Template (Auto-created)
   - Type: Binary decision
   - Duration: 48 hours
   - Eligible: All members except disputing parties
   - Quorum: 50%, Majority: 50%


================================================================================
5. AUTOMATED POLL ACTIONS
================================================================================

AUTOMATIC DISPUTE ESCALATION
---------------------------
Trigger: Dispute open >48 hours without admin resolution

```typescript
export async function escalateDisputeToPoll(disputeId: string) {
  const { data: dispute } = await supabase
    .from('disputes')
    .select('*')
    .eq('id', disputeId)
    .single()
  
  // Create poll
  const poll = {
    apartment_id: dispute.apartment_id,
    title: `Resolve Dispute: ${dispute.title}`,
    description: `This dispute has been escalated to voting.\n\n` +
                 `Original complaint: ${dispute.description}\n\n` +
                 `Please review the evidence and vote.`,
    poll_type: 'multiple_choice_single',
    start_date: new Date(),
    end_date: addHours(new Date(), 48),
    quorum_percentage: 50,
    majority_percentage: 50,
    show_results_during_voting: false,
    anonymous_voting: false,
    created_by: 'SYSTEM',
    status: 'active'
  }
  
  const { data: createdPoll } = await supabase
    .from('polls')
    .insert(poll)
    .select()
    .single()
  
  // Create options
  const options = [
    {
      poll_id: createdPoll.id,
      option_text: 'In favor of complainant',
      option_order: 1
    },
    {
      poll_id: createdPoll.id,
      option_text: 'In favor of admin decision',
      option_order: 2
    }
  ]
  
  await supabase.from('poll_options').insert(options)
  
  // Update dispute
  await supabase
    .from('disputes')
    .update({
      status: 'voting',
      poll_id: createdPoll.id
    })
    .eq('id', disputeId)
  
  // Notify all members
  await notifyAllMembers({
    apartmentId: dispute.apartment_id,
    title: 'âš–ï¸ Dispute Escalated to Voting',
    message: `A dispute requires your vote. Ends in 48 hours.`,
    link: `/polls/${createdPoll.id}/vote`
  })
}
```

AUTO-CLOSE POLLS
---------------
Scheduled Edge Function (runs every hour):

```typescript
export async function autoCloseExpiredPolls() {
  const now = new Date()
  
  // Find active polls past end date
  const { data: expiredPolls } = await supabase
    .from('polls')
    .select('*')
    .eq('status', 'active')
    .lt('end_date', now.toISOString())
  
  for (const poll of expiredPolls) {
    // Calculate results
    const results = await calculatePollResults(poll)
    
    // Update poll status
    await supabase
      .from('polls')
      .update({
        status: 'closed',
        final_results: results
      })
      .eq('id', poll.id)
    
    // Execute outcome if approved
    if (results.approved) {
      await executePollOutcome(poll, results)
    }
    
    // Notify all participants
    await notifyPollClosed(poll, results)
  }
}
```

POLL REMINDERS
-------------
Scheduled Edge Function (runs daily):

```typescript
export async function sendPollReminders() {
  // Find polls ending in 24 hours
  const tomorrow = addHours(new Date(), 24)
  
  const { data: endingSoon } = await supabase
    .from('polls')
    .select('*')
    .eq('status', 'active')
    .lte('end_date', tomorrow.toISOString())
  
  for (const poll of endingSoon) {
    // Find members who haven't voted
    const { data: nonVoters } = await supabase
      .from('apartment_members')
      .select('*')
      .eq('apartment_id', poll.apartment_id)
      .not('id', 'in', `(
        SELECT voter_member_id FROM poll_votes WHERE poll_id = '${poll.id}'
      )`)
    
    // Send reminder
    for (const member of nonVoters) {
      await sendNotification({
        userId: member.user_id,
        title: 'â° Poll Ending Soon',
        message: `"${poll.title}" ends in 24 hours. Cast your vote!`,
        link: `/polls/${poll.id}/vote`,
        channels: ['email', 'push', 'in_app']
      })
    }
  }
}
```

================================================================================
[Document Complete]
================================================================================

Pages Covered: 5 major pages
Components: 15+ reusable components
API Endpoints: 12+
Scheduled Functions: 3

Status: COMPLETE SPECIFICATION

